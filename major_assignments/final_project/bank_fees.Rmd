```{r}
library(tidyverse)
library(dplyr)
library(lubridate)
```

Questions: 1) How do campaigns decide what bank to use?
2) What are the most popular banks used to finance elections?
3) What makes smaller banks, such as Chain Bridge Bank and Middletown Valley Bank, so popular among campaigns?
4) Is there correlation between location and bank used?
5) Have there been any significant trends in banks used by election campaigns in the last five years?
6) Are any large banks not as popular when used for campaign finance?
7) Are certain banks more “Republican” and certain banks more “Democratic”?


```{r}
bank_fees_24 <- read_csv("2024_Bank_Fees.csv")
bank_fees_23 <- read_csv("2023_Bank_Fees.csv")
bank_fees_22 <- read_csv("2022_Bank_Fees.csv")
bank_fees_21 <- read_csv("2021_Bank_Fees.csv")
bank_fees_20 <- read_csv("2020_Bank_Fees.csv")
bank_fees_19 <- read_csv("2019_Bank_Fees.csv")

bank_fees_24$recipient_zip <- as.character(bank_fees_24$recipient_zip)
bank_fees_23$recipient_zip <- as.character(bank_fees_23$recipient_zip)
bank_fees_22$recipient_zip <- as.character(bank_fees_22$recipient_zip)
bank_fees_21$recipient_zip <- as.character(bank_fees_21$recipient_zip)
bank_fees_20$recipient_zip <- as.character(bank_fees_20$recipient_zip)
bank_fees_19$recipient_zip <- as.character(bank_fees_19$recipient_zip)


```

```{r}
core_data <- bind_rows(bank_fees_24, bank_fees_23, bank_fees_22, bank_fees_21, bank_fees_20, bank_fees_19)

core_data <- core_data %>% select(-image_number)
core_data <- core_data %>% select(-line_number)
core_data <- core_data %>% select(-entity_type_desc)
core_data <- core_data %>% select(-unused_recipient_committee_id)
core_data <- core_data %>% select(-recipient_committee_id)
core_data <- core_data %>% select(-national_committee_nonfederal_account)
core_data <- core_data %>% select(-memo_code_full)
core_data <- core_data %>% select(-original_sub_id)
core_data <- core_data %>% select(-back_reference_transaction_id)
core_data <- core_data %>% select(-back_reference_schedule_id)

core_data <- core_data %>% select(-starts_with("candidate_"))

core_data <- core_data %>% mutate(disbursement_date=mdy_hm(disbursement_date))

core_data <- core_data %>% mutate(bank_clean=recipient_name)

#step 1-remove non banks
#step 2-standardize

core_data <- core_data %>% filter(!recipient_name %in% c("ACTBLUE", "ANEDOT", "YU, EUGENE CHIN", "ZAHRADKA, TAWNJA", "VINCENT, ZACHARY", "VEED PRO", "US ONCOLOGY", "UNITEMIZED, EXPENSES", "UBER", "TOWNSEND FOR CONGRESS", "TARGETED VICTORY LLC", "TARGETED VICTORY", "STRIPE INC", "STRATEGIC PARTNERS & MEDIA LLC", "SOUTHERN IMPACT GROUP LLC", "SMALL UN-ITEMIZED EXPENDITURES", "SHAUN BROWN FOR VIRGINIA", "RYAN KRAUSE FOR CONGRESS", "SIFMA", "WILKINS STRATEGIES GROUP, LLC", "WESTERN ALLIANCE", "WALSH, SEAN P", "SOUTH MAIN STREET PROPERTIES II LTD", "SIGNAPAY", "RIGHT WOMEN PAC", "RAMOS, JAVIER", "PLUG & PLAY TECHNOLOGIES, INC.", "OLIVER, CHASE", "NORPAC", "NEW BLUE INTERACTIVE LLC", "NEW BLUE INTERACTIVE, LLC", "NATIONAL PROPANE GAS ASSOCIATION", "NCPSSM", "MITCHELL, CAITLIN", "MESSER CONSTRUCTION CO PAC", "MARSH AND MCLENNAN AGENCY LLC", "MARILYN FOR U S SENATE", "LEONID GRINBERG LLC", "K&L GATES LLP", "JUST REFORM PAC", "JONES, HUGH", "JANICEK FOR SENATE", "IMAGE DIRECT", "I. LANIER AVANT", "HUBBARD, LOURIN", "HONIGMAN, WILLIAM", "HOADLEY HOUSE LLC", "HENRYALAN", "GLOBAL SERVICE FEE", "GLOBAL PAYMENTS", "FRIENDS OF MICHAEL HOOD", "FOUTS, MATT", "GILSTRAP INC", "GILLERMAN, JONATHAN", "EZELL, MILTON LEVELL", "ELIAS LAW GROUP", "ELITEWORK PROPERTIES LLC", "EDUCATOR'S CU", "DONORBOX", "DIRECT MAIL PROCESSORS", "DIRECT MAIL PROCESSORS", "DEMATTEIS & RICCIARDELLO PLLC", "DC LOCKSMITH", "DANI FOR ILLINOIS", "DALSIMER, ALISON", "CONYERS, JOHN III", "CHICK-FIL-A", "CERTIFIED CONSERVATIVES PAC", "CALL HUB - GAGLERS INC.", "BRITEY LLC", "BROOKS FOR SENATE", "BRAINTREE", "BP BUSINESS CARD", "BILLHIGHWAY", "BIDPAL", "AUTHORIZENET", "AT&T", "ARK MED SOC PAC", "ARK MED SOCIETY PAC", "AMS POLITICAL ACTION COMMITTEE", "ACT BLUE AND BANK FEES", "10SIX CONSULTING", "WINRIGHT SRATEGIES, LLC", "WEBSITE HOSTING SERVICE", "VERITAS PROGRESSIVES PAC", "VANTIV ECOMMERCE", "TRUJILLO, CRYSTAL J DR.", "TRI COUNTIES", "THRIPP, RICHARD", "THREE ARBOR INSURANCE INC.", "THE GIVING BLOCK", "STEPHENS FOR CONGRESS", "SPEEDPRO IMAGING", "SALEM MEDIA GROUP", "RURAL ARIZONA ACTION", "REVV.CO DBA WINRED", "REVV FUNDRAISING PLATFORM", "RENASANT", "RAISE THE MONEY, INC.", "RAISE THE MONEY", "P & A ADMINISTRATIVE SERVICES INC", "PEX CARD", "NMI", "NGP VAN, INC.", "MOONCLERK", "LUCY LAUSER FOR CONGRESS", "JON CURTIS FOR CONGRESS", "HUDSON BAY COMPANY OF ILLINOIS", "HINDUS OF GEORGIA PAC", "GOODMAN CAMPAIGNS LLC", "GOOGLE", "VERGEBEN SERVICES COMPANY", "ACTBLUE TECHNICAL SERVICES", "ELAVON", "BLUEPAY, INC.", "SHOPIFY INC", "WINRED", "WEPAY, INC.", "OREGON RIGHT TO LIFE", "EDONATION.COM", "PAYPAL MERCHANT SOLUTIONS, NA", "SQUARE", "SQUARE INC", "VENMO", "PAYPAL", "AUTHORIZE NET", "ELEVON", "V24-013", "PIRYX, INC.", "DNC TRAVEL ESCROW", "ISTREAM", "ENGAGE POLITICS", "ELITE CARD PROCESSING", "WORLDPAY, INC", "TRANSAXT", "SQUARESPACE", "SQUARE FEES", "RALPH AND LOIS DREW TRUST", "SAFEGUARD", "PUBLIX", "PRO ISRAEL AMERICA PAC", "OREGON RIGHT TO LIFE - C4", "MAVERICK PAYMENTS (M - MERCHANT)", "INFINEX INVESTMENTS INC.", "FULLSTREAM", "GEMINI", "DUPACO", "DELUXE CORPORATION", "DELUXE", "DONORBUREAU", "COOPERATIVE FEDERAL", "COMCAST CABLE", "COMMITTEE TO ELECT NATE CAIN", "CIGAR-PAC", "ALLY WESTSHORE LLC", "AFFINIPAY", "TRANSFIRST HOLDINGS", "SOUTHWESTERN ILLINOIS LECET", "HSP", "HARLAND CLARKE CHECKS", "FIRSTDATA MERCHANT SERVICES", "DROPBOX", "CLOVER.COM", "COMMERCIAL CREDIT CARDS", "BANK,, WEBSITE FEES", "AMERICAN EXPRESS SKYE BLUE", "AMERICAN EXPRESS GOLD 2", "UNITED STATES POSTAL SERVICE", "STRIPE, INC", "TD BUSINESS CARD", "SIMMONS BANK CREDIT CARD #4514", "STRIKE WEALTH INVESTMENT", "PAYROLL DATA PROCESSING INC", "MASTERCARD SERVICE CENTER", "MERCHANT SERVICE FEES", "MASTERCARD", "FULLSTEAM", "COGENCY GLOBAL INC", "ELAVON INC.", "EAGLE CREDIT CARD", "DISCOVER IT CARD", "CAMPAIGN FINANCIAL SERVICES", "BENNET COLORADO VICTORY FUND", "BB&T BANK CARD", "CHASE BA VISA - SKYE", "CITYWIDE", "CITI PRESTIGE", "ARISTOTLE INTERNATIONAL, INC", "AMERICAN EXPRESS CARD SERVICES", "AMERICAN EXPRESS BLUE BUS+", "USPS", "9SEVEN CONSULTING", "ACTBLUE TECHINICAL SERVICES", "AADVANTAGE MASTERCARD", "STATION SQUARE LLC", "QUICKBOOKS MERCHANT SERVICES", "QUICKBOOKS MERCHANT SERVICES", "FRIENDS OF KIRBY BIRGANS", "INTUIT, INC.", "OPPENHEIMER & CO. INC.", "MSCPAC", "FEES, BANK", "ELITE CARD PRO", "FIRST DATA MERCHANT SERVICES, LLC", "CARDMEMBER SERVICES - CREDIT CARD", "BENESYS, INC.", "BRAND NEW SENATE", "CARD CONNECT", "CITI BUSINESS CARD", "BANK FEES", "APWU", "WIN RED TECHNICAL SERVICES LLC", "VERIDIAN", "SCHWAB-HELLER", "VANTIV ECOMMERCE FUNDS", "QR-CODE-GENERATOR.COM", "PARAGON SOLUTIONS", "PAYPAL FEES", "NON BB CARD NOT PRESENT", "HOLYK, ISAAC", "INTELLZ, INC.", "MERCHANT CARD PROCESSING", "EVERTEC, INC", "CFS COMPLIANCE", "CARD SERVICES", ) 
)

write_csv(core_data %>% select(recipient_name, bank_clean), "banks_for_open_refine.csv")

```


```{r}
core_data %>% 
  group_by(recipient_name) %>% 
  summarize(transactions = n()) %>% 
  arrange(desc(transactions))
```