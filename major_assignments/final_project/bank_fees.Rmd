```{r}
library(tidyverse)
library(dplyr)
library(lubridate)
```

Questions: 1) How do campaigns decide what bank to use?
2) What are the most popular banks used to finance elections?
3) What makes smaller banks, such as Chain Bridge Bank and Middletown Valley Bank, so popular among campaigns?
4) Is there correlation between location and bank used?
5) Have there been any significant trends in banks used by election campaigns in the last five years?
6) Are any large banks not as popular when used for campaign finance?
7) Are certain banks more “Republican” and certain banks more “Democratic”?


```{r}
bank_fees_24 <- read_csv("2024_Bank_Fees.csv")
bank_fees_23 <- read_csv("2023_Bank_Fees.csv")
bank_fees_22 <- read_csv("2022_Bank_Fees.csv")
bank_fees_21 <- read_csv("2021_Bank_Fees.csv")
bank_fees_20 <- read_csv("2020_Bank_Fees.csv")
bank_fees_19 <- read_csv("2019_Bank_Fees.csv")

bank_fees_24$recipient_zip <- as.character(bank_fees_24$recipient_zip)
bank_fees_23$recipient_zip <- as.character(bank_fees_23$recipient_zip)
bank_fees_22$recipient_zip <- as.character(bank_fees_22$recipient_zip)
bank_fees_21$recipient_zip <- as.character(bank_fees_21$recipient_zip)
bank_fees_20$recipient_zip <- as.character(bank_fees_20$recipient_zip)
bank_fees_19$recipient_zip <- as.character(bank_fees_19$recipient_zip)


```

```{r}
core_data <- bind_rows(bank_fees_24, bank_fees_23, bank_fees_22, bank_fees_21, bank_fees_20, bank_fees_19)

core_data <- core_data %>% select(-image_number)
core_data <- core_data %>% select(-line_number)
core_data <- core_data %>% select(-entity_type_desc)
core_data <- core_data %>% select(-unused_recipient_committee_id)
core_data <- core_data %>% select(-recipient_committee_id)
core_data <- core_data %>% select(-national_committee_nonfederal_account)
core_data <- core_data %>% select(-memo_code_full)
core_data <- core_data %>% select(-original_sub_id)
core_data <- core_data %>% select(-back_reference_transaction_id)
core_data <- core_data %>% select(-back_reference_schedule_id)

core_data <- core_data %>% select(-starts_with("candidate_"))

core_data <- core_data %>% mutate(disbursement_date=mdy_hm(disbursement_date))

core_data <- core_data %>% mutate(bank_clean=recipient_name)

#step 1-remove non banks
#step 2-standardize

core_data <- core_data %>% filter(!recipient_name %in% c("ACTBLUE", "ANEDOT", "YU, EUGENE CHIN", "ZAHRADKA, TAWNJA")
)

write_csv(core_data %>% select(recipient_name, bank_clean), "banks_for_open_refine.csv")

```


```{r}
core_data %>% 
  group_by(recipient_name) %>% 
  summarize(transactions = n()) %>% 
  arrange(desc(transactions))
```